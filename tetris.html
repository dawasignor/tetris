<!DOCTYPE html>
<html>
<head>
  <title>Tetris Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
      
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
      
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
      <link rel="stylesheet" href="tetris.css">

      <script type="text/javascript" src="background.js"></script>
      
</head>
<body>
    <div class = "container-fluid p-0">
        <div class = "row align-items-start">
            <div id="box1" style="height: 100vh; width: 25vw; background-color:yellow;">
                
            </div>
            <div id="left-wall" style="background-color:gray; height: 100vh; width: 5vw;">     
            </div>
            <div class="centerBox " style=" background-color:  aquamarine;height: 100vh; width: 40vw;">
                <div class="container-fluid p-0" id="play-area">
                    <div class="container-fluid  active-block p-0" id ="1">
                        <div class = "row align-items-start">
                            <div class="col-lg-2 square top-left"></div>
                            <div class="col-lg-2 square top-right"></div>
                        </div>
                        <div class = "row align-items-start">
                            <div class="col-lg-2 square bot-left"></div>
                            <div class="col-lg-2 square bot-right"></div>
                        </div>
                    </div>
                </div>
                <div style="background-color:black; position: absolute; top: 96vh; left: 29.1vw; height: 4vh; width: 40vw; border-style: dashed; border-width: 1px; padding-left: 0px;" ></div>
            </div>
            <div id="right-wall" style="background-color:gray; height: 100vh; width: 5vw;">     
            </div>

            <div class="box3" style=" height: 100vh; width: 25vw; background-color:pink;">
                <button onclick="moveblock()">Move</button>
            </div>
        </div>
    </div>


</body>

<script>

    let ActiveBlockId=1;
    let activeBlock = document.querySelector(".active-block");

    //drawbg();
    function start(){
        setInterval(updateBlockID,2000);
    }
    
    document.getElementById("play-area").addEventListener("transitionend",function(eventEnd){if(eventEnd.propertyName == 'transform'){console.log("calling updateActiveBlock");
        updateActiveBlock()}}); 

    window.addEventListener("keydown",moveRightOrLeft,false);

    function moveRightOrLeft(evt){
        event.preventDefault();

        switch(evt.key){
            case "ArrowLeft":
                console.log("Left");
            break;
            case "ArrowRight":
                console.log("Right");
            break;
        }
    }
    function updateBlockID(){
        activeBlock = document.querySelector(".active-block");
        console.log(activeBlock.id);
               
    }

    function updateActiveBlock(){
        //setTimeout(() =>{ console.log("new block")},500);
        el = document.querySelector(".active-block");
        el.classList.remove("active-block")
        addActiveBlock();
        el = document.querySelector(".active-block");
        setTimeout(() => {el.classList.add("move");},200);
        ActiveBlockId++;

        
    }
    
    function moveblock(){       
    document.getElementById("1").classList.add("move");
    start();
    }

    
    
</script>
</html>